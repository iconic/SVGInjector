!function(window,document){"use strict";function uniqueClasses(list){list=list.split(" ");for(var hash={},i=list.length,out=[];i--;)hash.hasOwnProperty(list[i])||(hash[list[i]]=1,out.unshift(list[i]));return out.join(" ")}var isLocal="file:"===window.location.protocol,hasSvgSupport=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),forEach=Array.prototype.forEach||function(fn,scope){if(void 0===this||null===this||"function"!=typeof fn)throw new TypeError;var i,len=this.length>>>0;for(i=0;len>i;++i)i in this&&fn.call(scope,this[i],i,this)},svgCache={},injectCount=0,injectedElements=[],requestQueue=[],ranScripts={},cloneSvg=function(sourceSvg){return sourceSvg.cloneNode(!0)},queueRequest=function(url,callback){requestQueue[url]=requestQueue[url]||[],requestQueue[url].push(callback)},processRequestQueue=function(url){for(var i=0,len=requestQueue[url].length;len>i;i++)!function(index){setTimeout(function(){requestQueue[url][index](cloneSvg(svgCache[url]))},0)}(i)},loadSvg=function(url,callback){if(void 0!==svgCache[url])svgCache[url]instanceof SVGSVGElement?callback(cloneSvg(svgCache[url])):queueRequest(url,callback);else{if(!window.XMLHttpRequest)return callback("Browser does not support XMLHttpRequest"),!1;svgCache[url]={},queueRequest(url,callback);var httpRequest=new XMLHttpRequest;httpRequest.onreadystatechange=function(){if(4===httpRequest.readyState){if(404===httpRequest.status||null===httpRequest.responseXML)return callback("Unable to load SVG file: "+url),isLocal&&callback("Note: SVG injection ajax calls do not work locally without adjusting security setting in your browser. Or consider using a local webserver."),callback(),!1;if(!(200===httpRequest.status||isLocal&&0===httpRequest.status))return callback("There was a problem injecting the SVG: "+httpRequest.status+" "+httpRequest.statusText),!1;if(httpRequest.responseXML instanceof Document)svgCache[url]=httpRequest.responseXML.documentElement;else if(DOMParser&&DOMParser instanceof Function){var xmlDoc;try{var parser=new DOMParser;xmlDoc=parser.parseFromString(httpRequest.responseText,"text/xml")}catch(e){xmlDoc=void 0}if(!xmlDoc||xmlDoc.getElementsByTagName("parsererror").length)return callback("Unable to parse SVG file: "+url),!1;svgCache[url]=xmlDoc.documentElement}processRequestQueue(url)}},httpRequest.open("GET",url),httpRequest.overrideMimeType&&httpRequest.overrideMimeType("text/xml"),httpRequest.send()}},injectElement=function(el,evalScripts,pngFallback,callback){var imgUrl=el.getAttribute("data-src")||el.getAttribute("src");if(!/\.svg/i.test(imgUrl))return void callback("Attempted to inject a file with a non-svg extension: "+imgUrl);if(!hasSvgSupport){var perElementFallback=el.getAttribute("data-fallback")||el.getAttribute("data-png");return void(perElementFallback?(el.setAttribute("src",perElementFallback),callback(null)):pngFallback?(el.setAttribute("src",pngFallback+"/"+imgUrl.split("/").pop().replace(".svg",".png")),callback(null)):callback("This browser does not support SVG and no PNG fallback was defined."))}-1===injectedElements.indexOf(el)&&(injectedElements.push(el),el.setAttribute("src",""),loadSvg(imgUrl,function(svg){if("undefined"==typeof svg||"string"==typeof svg)return callback(svg),!1;var imgId=el.getAttribute("id");imgId&&svg.setAttribute("id",imgId);var imgAlt=el.getAttribute("alt");imgAlt&&(svg.setAttribute("title",imgAlt),svg.getAttribute("title").setAttribute("id","title"),svg.setAttribute("aria-labelledby","title")),svg.setAttribute("role","img");var classMerge=[].concat(svg.getAttribute("class")||[],"injected-svg",el.getAttribute("class")||[]).join(" ");svg.setAttribute("class",uniqueClasses(classMerge));var imgStyle=el.getAttribute("style");imgStyle&&svg.setAttribute("style",imgStyle);var imgData=[].filter.call(el.attributes,function(at){return/^data-\w[\w\-]*$/.test(at.name)});forEach.call(imgData,function(dataAttr){dataAttr.name&&dataAttr.value&&svg.setAttribute(dataAttr.name,dataAttr.value)});for(var newClipPathName,clipPaths=svg.querySelectorAll("defs clipPath[id]"),g=0,clipPathsLen=clipPaths.length;clipPathsLen>g;g++){newClipPathName=clipPaths[g].id+"-"+injectCount;for(var usingClipPath=svg.querySelectorAll('[clip-path*="'+clipPaths[g].id+'"]'),h=0,usingClipPathLen=usingClipPath.length;usingClipPathLen>h;h++)usingClipPath[h].setAttribute("clip-path","url(#"+newClipPathName+")");clipPaths[g].id=newClipPathName}for(var newMaskName,masks=svg.querySelectorAll("defs mask[id]"),i=0,masksLen=masks.length;masksLen>i;i++){newMaskName=masks[i].id+"-"+injectCount;for(var usingMask=svg.querySelectorAll('[mask*="'+masks[i].id+'"]'),j=0,usingMaskLen=usingMask.length;usingMaskLen>j;j++)usingMask[j].setAttribute("mask","url(#"+newMaskName+")");masks[i].id=newMaskName}svg.removeAttribute("xmlns:a");for(var script,scriptType,scripts=svg.querySelectorAll("script"),scriptsToEval=[],k=0,scriptsLen=scripts.length;scriptsLen>k;k++)scriptType=scripts[k].getAttribute("type"),scriptType&&"application/ecmascript"!==scriptType&&"application/javascript"!==scriptType||(script=scripts[k].innerText||scripts[k].textContent,scriptsToEval.push(script),svg.removeChild(scripts[k]));if(scriptsToEval.length>0&&("always"===evalScripts||"once"===evalScripts&&!ranScripts[imgUrl])){for(var l=0,scriptsToEvalLen=scriptsToEval.length;scriptsToEvalLen>l;l++)new Function(scriptsToEval[l])(window);ranScripts[imgUrl]=!0}var styleTags=svg.querySelectorAll("style");forEach.call(styleTags,function(styleTag){styleTag.textContent+=""}),el.parentNode.replaceChild(svg,el),delete injectedElements[injectedElements.indexOf(el)],el=null,injectCount++,callback(svg)}))},SVGInjector=function(elements,options,done){options=options||{};var evalScripts=options.evalScripts||"always",pngFallback=options.pngFallback||!1,eachCallback=options.each;if(void 0!==elements.length){var elementsLoaded=0;forEach.call(elements,function(element){injectElement(element,evalScripts,pngFallback,function(svg){eachCallback&&"function"==typeof eachCallback&&eachCallback(svg),done&&elements.length===++elementsLoaded&&done(elementsLoaded)})})}else elements?injectElement(elements,evalScripts,pngFallback,function(svg){eachCallback&&"function"==typeof eachCallback&&eachCallback(svg),done&&done(1),elements=null}):done&&done(0)};"object"==typeof module&&"object"==typeof module.exports?module.exports=exports=SVGInjector:"function"==typeof define&&define.amd?define(function(){return SVGInjector}):"object"==typeof window&&(window.SVGInjector=SVGInjector)}(window,document);
//# sourceMappingURL=dist/svg-injector.map.js